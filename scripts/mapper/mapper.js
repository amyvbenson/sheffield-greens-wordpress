var canvascheck=document.createElement('canvas');var isIE=window.navigator.systemLanguage?1:0;var isVM=document.namespaces?1:0;var isJG=0;var isCV=canvascheck.getContext?1:0;var jg=new Array();if(isVM){if(document.namespaces['v']==null){var e=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","roundrect","oval","rect","arc","image"],s=document.createStyleSheet();for(var i=0;i<e.length;i++){s.addRule("v\\:"+e[i],"behavior: url(#default#VML); antialias: true;")}document.namespaces.add("v","urn:schemas-microsoft-com:vml")}}function showCoords(a,b,x,y,w,h){}function getClasses(a,b){var c='';for(var j=0;j<a.length;j++){if(a[j]!=b){if(c){c+=' '}c+=a[j]}}return c}function getClassValue(a,b){var c=0;var d=b.length;for(var j=0;j<a.length;j++){if(a[j].indexOf(b)==0){c=Math.min(a[j].substring(d),100);break}}return Math.max(0,c)}function getClassRGBColor(b,c,d){var e,val=d,pos=c.length;for(var j=0;j<b.length;j++){if(b[j].indexOf(c)==0){e=b[j].substring(pos);val=e.toLowerCase();break}}if(!val.match(/^[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i)){val=d||'000000'}if(!isCV){return val}else{function hex2dec(a){return(Math.max(0,Math.min(parseInt(a,16),255)))}var f=hex2dec(val.substr(0,2)),cg=hex2dec(val.substr(2,2)),cb=hex2dec(val.substr(4,2));return f+','+cg+','+cb}}function getClassAttribute(a,b){var c=0;var d=b.length;for(var j=0;j<a.length;j++){if(a[j].indexOf(b)==0){c=1;break}}return c}function getMaps(a){var b=document.getElementsByTagName('img');var c=new Array();var i=0;var d='';var e;var f;var j=0;var g='';for(i=0;i<b.length;i++){e=b[i];f=e.className.split(' ');for(j=0;j<f.length;j++){if(f[j]==a){d=e.useMap.split("#");if(d[1]!=''&&d[1].length>=1){g=document.getElementsByName(d[1]);if(g){c.push(e);break}}}}}return c}function fadeCanvas(a,b){var c=document.getElementById(a);if(c.fading==1&&b<=100){c.style.opacity=b/100;b+=10;window.setTimeout("fadeCanvas('"+a+"',"+b+")",10)}}function setAreaOver(e,g,h,m,q,s,f,z){var a,i,j,d,c,o,b,n,l,r,v,u,x,y,p,k=0,t='',r=e.getAttribute('rel'),context,canvas=document.getElementById(g);if(r!=null){d=r.split(",");v=d.unshift(e.id)}else{d=new Array(e.id)}function setAttr(){if(l.indexOf('forcegroup')!=-1){k=getClassAttribute(u,"forcegroup")}else{k=0}if(l.indexOf('iopacity')!=-1){o=getClassValue(u,"iopacity")/100}else{o=q}if(l.indexOf('iborder')!=-1){b=getClassRGBColor(u,"iborder",h)}else{b=h}if(l.indexOf('icolor')!=-1){c=getClassRGBColor(u,"icolor",m)}else{c=m}if(l.indexOf('noborder')!=-1){n=getClassAttribute(u,"noborder")}else{n=s}}if(isVM){for(a=0;a<d.length;a++){e=document.getElementById(d[a]);if(e){p='',l=e.className,u=l.split(" "),v=e.coords.split(",");if(k==0){setAttr()}if(e.shape.toLowerCase()=='rect'){t+='<v:rect strokeweight="1" filled="t" stroked="'+(n<1?"t":"f")+'" strokecolor="#'+b+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(v[0])+'px;top:'+parseInt(v[1])+'px;width:'+parseInt(v[2]-v[0])+'px;height:'+parseInt(v[3]-v[1])+'px;"><v:fill color="#'+c+'" opacity="'+o+'" /></v:rect>'}else if(e.shape.toLowerCase()=='circle'){t+='<v:oval strokeweight="1" filled="t" stroked="'+(n<1?"t":"f")+'" strokecolor="#'+b+'" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+parseInt(v[0]-v[2])+'px;top:'+parseInt(v[1]-v[2])+'px;width:'+(parseInt(v[2])*2)+'px;height:'+(parseInt(v[2])*2)+'px;"><v:fill color="#'+c+'" opacity="'+o+'" /></v:oval>'}else{for(j=2;j<v.length;j+=2){p+=parseInt(v[j])+','+parseInt(v[j+1])+','}t+='<v:shape strokeweight="1" filled="t" stroked="'+(n<1?"t":"f")+'" strokecolor="#'+b+'" coordorigin="0,0" coordsize="'+canvas.width+','+canvas.height+'" path="m '+parseInt(v[0])+','+parseInt(v[1])+' l '+p+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+canvas.width+'px;height:'+canvas.height+'px;"><v:fill color="#'+c+'" opacity="'+o+'" /></v:shape>'}}}canvas.innerHTML=t}else if(isCV){if(f<1){canvas.fading=0;canvas.style.opacity=0}context=canvas.getContext("2d");for(a=0;a<d.length;a++){e=document.getElementById(d[a]);if(e){l=e.className,u=l.split(" "),v=e.coords.split(",");if(k==0){setAttr()}context.beginPath();if(e.shape.toLowerCase()=='rect'){context.rect(0.5+parseInt(v[0]),0.5+parseInt(v[1]),parseInt(v[2]-v[0]),parseInt(v[3]-v[1]));context.closePath()}else if(e.shape.toLowerCase()=='circle'){context.arc(0.5+parseInt(v[0]),0.5+parseInt(v[1]),parseInt(v[2]),0,(Math.PI/180)*360,false)}else{context.moveTo(parseInt(v[0]),parseInt(v[1]));for(j=2;j<v.length;j+=2){context.lineTo(parseInt(v[j]),parseInt(v[j+1]))}context.closePath()}context.fillStyle='rgba('+c+','+o+')';context.strokeStyle='rgba('+b+',1)';context.fill();if(n<1){context.stroke()}}}if(f<1){canvas.fading=1;fadeCanvas(g,0)}}else{o=q;l=e.className;u=l.split(" ");if(l.indexOf('forcegroup')!=-1){k=getClassAttribute(u,"forcegroup");if(k!=0){if(l.indexOf('iopacity')!=-1){o=getClassValue(u,"iopacity")/100;k=0}}}if(isIE){canvas.style.filter="Alpha(opacity="+(o*100)+")"}else{canvas.style.opacity=o;canvas.style.MozOpacity=o;canvas.style.KhtmlOpacity=o}for(a=0;a<d.length;a++){e=document.getElementById(d[a]);if(e){l=e.className,u=l.split(" "),v=e.coords.split(",");if(k==0){if(l.indexOf('forcegroup')!=-1){k=getClassAttribute(u,"forcegroup")}else{k=0}if(l.indexOf('icolor')!=-1){c=getClassRGBColor(u,"icolor",m)}else{c=m}}jg[z].setColor("#"+c);if(e.shape.toLowerCase()=='rect'){jg[z].fillRect(parseInt(v[0]),parseInt(v[1]),parseInt(v[2]-v[0])+1,parseInt(v[3]-v[1])+1)}else if(e.shape.toLowerCase()=='circle'){jg[z].fillEllipse(parseInt(v[0]-v[2]),parseInt(v[1]-v[2]),parseInt(v[2])*2+1,parseInt(v[2])*2+1)}else{x=new Array();y=new Array();i=0;for(j=0;j<v.length;j+=2){x[i]=parseInt(v[j]);y[i]=parseInt(v[j+1]);i++}jg[z].fillPolygon(x,y)}jg[z].paint()}}}}function setAreaOut(a,b,f,z){var c=document.getElementById(b);if(isVM){c.innerHTML=''}else if(isJG){jg[z].clear()}else if(isCV){var d=c.getContext("2d");d.clearRect(0,0,c.width,c.height)}}function getCoords(e,n,a,i,x,y,w,h,b,c){var t,o,ox,oy,ex,ey,cx,cy,px=0,py=0;if(!e){e=window.event}if(e.pageX||e.pageY){px=e.pageX;py=e.pageY}ex=e.clientX;ey=e.clientY;if(self.pageXOffset||self.pageYOffset){ox=self.pageXOffset;if(ox>0&&px==ex){ex-=ox}oy=self.pageYOffset;if(oy>0&&py==ey){ey-=oy}}else if(document.documentElement){ox=document.documentElement.scrollLeft;oy=document.documentElement.scrollTop}else if(document.body){ox=document.body.scrollLeft;oy=document.body.scrollTop}if(document.body.scrollHeight!=c||document.body.scrollWidth!=b){var o=document.getElementById(i);var t=findPosXY(o);x=t.x;y=t.y}cx=Math.min(Math.max(ex+ox-x,0),w);cy=Math.min(Math.max(ey+oy-y,0),h);showCoords(n,a,cx,cy,w,h)}function findPosXY(a){var t;var d={x:a.offsetLeft,y:a.offsetTop};if(a.offsetParent){t=findPosXY(a.offsetParent);d.x+=t.x;d.y+=t.y}return d}function roundedRect(a,x,y,b,c,d,e){if(!e)a.beginPath();a.moveTo(x,y+d);a.lineTo(x,y+c-d);a.quadraticCurveTo(x,y+c,x+d,y+c);a.lineTo(x+b-d,y+c);a.quadraticCurveTo(x+b,y+c,x+b,y+c-d);a.lineTo(x+b,y+d);a.quadraticCurveTo(x+b,y,x+b-d,y);a.lineTo(x+d,y);a.quadraticCurveTo(x,y,x,y+d);if(!e)a.closePath()}function getRadius(a,b,c){var d=(Math.min(b,c)/100);a=Math.max(Math.min(100,a/d),0);return a+'%'}function addMapper(){var a=getMaps('mapper');var e,object,bgrnd,canvas,blind,context,mapid,mname,ele,atr;var g='',newClasses='',func='',tmp,i,j,o,b,c,d,r,t,n,f,x,y,w,h,pw,ph;for(i=0;i<a.length;i++){e=a[i];object=e.parentNode;if(e.id==''){e.id="gmipam_"+i}object.style.position=(object.style.position=='static'||object.style.position==''?'relative':object.style.position);object.style.height=e.height+'px';object.style.width=e.width+'px';object.style.padding=0+'px';object.style.MozUserSelect="none";object.style.KhtmlUserSelect="none";object.unselectable="on";r=0;n=0;f=0;b='0000ff';c='000000';o=33;if(isCV){canvas=document.createElement('canvas')}else if(isVM){canvas=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+e.width+'px;height:'+e.height+'px;padding:0;">'].join(''))}else{canvas=document.createElement('div')}canvas.id=e.id+'_canvas';g=e.className.split(' ');r=getClassValue(g,"iradius");o=getClassValue(g,"iopacity");b=getClassRGBColor(g,"iborder",'0000ff');c=getClassRGBColor(g,"icolor",'000000');n=getClassAttribute(g,"noborder");f=getClassAttribute(g,"nofade");d=getClassAttribute(g,"showcoords");o=o==0?0.33:o/100;r=parseInt(Math.min(Math.min(e.width/4,e.height/4),r));newClasses=getClasses(g,"mapper");e.className=newClasses;mname=e.useMap.split("#");mname=mname[1];mapid=document.getElementsByName(mname);if(mapid.length>0){for(j=0;j<mapid[0].areas.length;j++){if(mapid[0].areas[j].shape.match(/(rect|poly|circle)/i)){if(window.opera||mapid[0].areas[j].coords!=''){if(mapid[0].areas[j].id==''){mapid[0].areas[j].id=mname+'_'+j}if(isVM||isIE){func=mapid[0].areas[j].onmouseover;if(func!=null){tmp=String(func);func=tmp.substr(23,tmp.length-25)}mapid[0].areas[j].onmouseover=new Function('setAreaOver(this,"'+canvas.id+'","'+b+'","'+c+'","'+o+'",'+n+','+f+','+i+');'+func);func=mapid[0].areas[j].onmouseout;if(func!=null){tmp=String(func);func=tmp.substr(23,tmp.length-25)}mapid[0].areas[j].onmouseout=new Function('setAreaOut(this,"'+canvas.id+'",'+f+','+i+');'+func)}else{func=mapid[0].areas[j].getAttribute("onmouseover");mapid[0].areas[j].setAttribute("onmouseover","setAreaOver(this,'"+canvas.id+"','"+b+"','"+c+"','"+o+"',"+n+","+f+","+i+");"+func);func=mapid[0].areas[j].getAttribute("onmouseout");mapid[0].areas[j].setAttribute("onmouseout","setAreaOut(this,'"+canvas.id+"',"+f+","+i+");"+func)}}}}}canvas.style.height=e.height+'px';canvas.style.width=e.width+'px';canvas.height=e.height;canvas.width=e.width;canvas.left=0;canvas.top=0;canvas.style.position='absolute';canvas.style.left=0+'px';canvas.style.top=0+'px';canvas.fading=0;e.className='';e.style.cssText='';e.left=0;e.top=0;e.style.position='absolute';e.style.height=e.height+'px';e.style.width=e.width+'px';e.style.left=0+'px';e.style.top=0+'px';e.style.MozUserSelect="none";e.style.KhtmlUserSelect="none";e.unselectable="on";if(isIE){e.style.filter="Alpha(opacity=0)"}else{e.style.opacity=0;e.style.MozOpacity=0;e.style.KhtmlOpacity=0}if(isCV&&r>0){bgrnd=document.createElement('canvas')}else if(isVM&&r>0){bgrnd=document.createElement(['<var style="zoom:1;overflow:hidden;display:block;width:'+e.width+'px;height:'+e.height+'px;padding:0;">'].join(''))}else{bgrnd=document.createElement('img');bgrnd.src=e.src}bgrnd.id=e.id+'_image';bgrnd.left=0;bgrnd.top=0;bgrnd.style.position='absolute';bgrnd.style.height=e.height+'px';bgrnd.style.width=e.width+'px';bgrnd.style.left=0+'px';bgrnd.style.top=0+'px';object.insertBefore(canvas,e);blind=document.createElement('div');blind.id=mname+'_blind';blind.className="blind_area";blind.left=0;blind.top=0;blind.style.position='absolute';blind.style.height=e.height+'px';blind.style.width=e.width+'px';blind.style.left=0+'px';blind.style.top=0+'px';blind.innerHTML=" ";object.insertBefore(blind,e);if(isCV){context=canvas.getContext("2d");context.clearRect(0,0,canvas.width,canvas.height)}else if(!isVM&&!isCV){if(isIE){canvas.style.filter="Alpha(opacity="+(o*100)+")"}else{canvas.style.opacity=o;canvas.style.MozOpacity=o;canvas.style.KhtmlOpacity=o}if(typeof(window['jsGraphics'])!=='undefined'){jg[i]=new jsGraphics(canvas);isJG=1}}object.insertBefore(bgrnd,canvas);if(isCV&&r>0){bgrnd.height=e.height;bgrnd.width=e.width;context=bgrnd.getContext("2d");context.clearRect(0,0,bgrnd.width,bgrnd.height);roundedRect(context,0,0,bgrnd.width,bgrnd.height,r);context.clip();context.fillStyle='rgba(0,0,0,0)';context.fillRect(0,0,bgrnd.width,bgrnd.height);context.drawImage(e,0,0,bgrnd.width,bgrnd.height)}else if(isVM&&r>0){bgrnd.height=e.height;bgrnd.width=e.width;r=getRadius(r,bgrnd.width,bgrnd.height);bgrnd.innerHTML='<v:roundrect arcsize="'+r+'" strokeweight="0" filled="t" stroked="f" fillcolor="#ffffff" style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:0px;top:0px;width:'+bgrnd.width+'px;height:'+bgrnd.height+'px;"><v:fill src="'+e.src+'" type="frame" /></v:roundrect>'}if(d>0){ele=document.getElementById(e.id);w=parseInt(e.width);h=parseInt(e.height);t=findPosXY(ele);x=t.x;y=t.y;ph=document.body.scrollHeight;pw=document.body.scrollWidth;if(isVM||isIE){func=e.onmousemove;if(func!=null){tmp=String(func);func=tmp.substr(23,tmp.length-25)}e.onmousemove=new Function('getCoords(event,"'+mname+'",0,"'+e.id+'",'+x+','+y+','+w+','+h+','+pw+','+ph+');'+func)}else{func=e.getAttribute("onmousemove");e.setAttribute("onmousemove","getCoords(event,'"+mname+"',0,'"+e.id+"',"+x+","+y+","+w+","+h+","+pw+","+ph+");"+func)}if(mapid.length>0){for(j=0;j<mapid[0].areas.length;j++){if(mapid[0].areas[j].shape.match(/(rect|poly|circle)/i)){if(window.opera||mapid[0].areas[j].coords!=''){atr=mapid[0].areas[j].id;if(isVM||isIE){func=mapid[0].areas[j].onmousemove;if(func!=null){tmp=String(func);func=tmp.substr(23,tmp.length-25)}mapid[0].areas[j].onmousemove=new Function('getCoords(event,"'+mname+'","'+atr+'","'+e.id+'",'+x+','+y+','+w+','+h+','+pw+','+ph+');'+func)}else{func=mapid[0].areas[j].getAttribute("onmousemove");mapid[0].areas[j].setAttribute("onmousemove","getCoords(event,'"+mname+"','"+atr+"','"+e.id+"',"+x+","+y+","+w+","+h+","+pw+","+ph+");"+func)}}}}}}}}var mapperOnload=window.onload;window.onload=function(){if(mapperOnload)mapperOnload();addMapper()}